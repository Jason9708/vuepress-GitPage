<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>配置webpack-dev-server | CHICAGO</title>
    <meta name="description" content="前端仔的自我挣扎">
    <link rel="icon" href="/vuepress-GitPage/logo/favicon.ico">
    
    <link rel="preload" href="/vuepress-GitPage/assets/css/0.styles.01a33ba5.css" as="style"><link rel="preload" href="/vuepress-GitPage/assets/js/app.37ca189d.js" as="script"><link rel="preload" href="/vuepress-GitPage/assets/js/2.155b04c3.js" as="script"><link rel="preload" href="/vuepress-GitPage/assets/js/38.525fc624.js" as="script"><link rel="prefetch" href="/vuepress-GitPage/assets/js/10.46b0086b.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/11.daa4a2a6.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/12.6b9c3e62.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/13.5c18fc57.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/14.e416db64.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/15.eea646e9.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/16.c3ddacbb.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/17.9c92be23.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/18.1cef88cc.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/19.0007bb60.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/20.ad873dd4.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/21.5c85b951.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/22.1832ea7c.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/23.2ed17f39.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/24.dc466810.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/25.320dfa10.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/26.41238810.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/27.a9e293a0.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/28.440fd059.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/29.d7f07814.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/3.22f6a7dc.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/30.fb22e215.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/31.ddcc866e.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/32.c8af0786.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/33.f19150ca.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/34.40efca14.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/35.1ab28b4a.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/36.003bb1fe.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/37.6bf9045f.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/39.b5dfca7e.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/4.310e4e99.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/40.79c4b5aa.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/41.0a309ba6.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/42.015a20c9.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/5.10910fab.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/6.9de72c04.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/7.c8439b32.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/8.9911e584.js"><link rel="prefetch" href="/vuepress-GitPage/assets/js/9.79c793b2.js">
    <link rel="stylesheet" href="/vuepress-GitPage/assets/css/0.styles.01a33ba5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-GitPage/" class="home-link router-link-active"><!----> <span class="site-name">CHICAGO</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-GitPage/interview/" class="nav-link">前端面试专栏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端小册" class="dropdown-title"><span class="title">前端小册</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-GitPage/webpack/" class="nav-link router-link-active">Webpack</a></li><li class="dropdown-item"><!----> <a href="/vuepress-GitPage/designpattern/" class="nav-link">Designpattern</a></li><li class="dropdown-item"><!----> <a href="/vuepress-GitPage/handwrittenScript/" class="nav-link">常见前端面试手写题</a></li><li class="dropdown-item"><!----> <a href="/vuepress-GitPage/flutterNote/" class="nav-link">Flutter</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Jason9708" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-GitPage/interview/" class="nav-link">前端面试专栏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端小册" class="dropdown-title"><span class="title">前端小册</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-GitPage/webpack/" class="nav-link router-link-active">Webpack</a></li><li class="dropdown-item"><!----> <a href="/vuepress-GitPage/designpattern/" class="nav-link">Designpattern</a></li><li class="dropdown-item"><!----> <a href="/vuepress-GitPage/handwrittenScript/" class="nav-link">常见前端面试手写题</a></li><li class="dropdown-item"><!----> <a href="/vuepress-GitPage/flutterNote/" class="nav-link">Flutter</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Jason9708" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vuepress-GitPage/webpack/" class="sidebar-link">webpack小册</a></li><li><a href="/vuepress-GitPage/webpack/webpack01/" class="sidebar-link">webpack 如何解析代码模块路径</a></li><li><a href="/vuepress-GitPage/webpack/webpack02/" class="sidebar-link">loader 与 plugin</a></li><li><a href="/vuepress-GitPage/webpack/webpack03/" class="active sidebar-link">配置webpack-dev-server</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress-GitPage/webpack/webpack04/" class="sidebar-link">区分开发与生产环境</a></li><li><a href="/vuepress-GitPage/webpack/webpack05/" class="sidebar-link">用HMR提高开发效率</a></li><li><a href="/vuepress-GitPage/webpack/webpack06/" class="sidebar-link">通过webpack优化前端环境</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="配置webpack-dev-server"><a href="#配置webpack-dev-server" class="header-anchor">#</a> 配置webpack-dev-server</h1> <p>在开发流程中，我们在部署到生产环境之前，都应该是在本地上先开发，运行我们写的代码，我们称为<strong>本地环境</strong>，这个环境相当于提供了一个简单的服务器，用于访问<code>webpack</code>构建好的静态文件。</p> <p>（在开发中我们用它来调式代码）</p> <p><code>webpack-dev-server</code>是<code>webpack</code>提供的一个工具，可以基于当前的<code>webpack</code>配置快速启动一个<strong>静态服务</strong>.</p> <p>当<code>mode</code>为<code>development</code>时，会具备热更新的功能（实时根据修改刷新当前页面）</p> <h3 id="webpack-dev-server-官方文档"><a href="#webpack-dev-server-官方文档" class="header-anchor">#</a> webpack-dev-server 官方文档</h3> <p>https://webpack.docschina.org/configuration/dev-server/</p> <h3 id="webpack-dev-server的基础使用"><a href="#webpack-dev-server的基础使用" class="header-anchor">#</a> webpack-dev-server的基础使用</h3> <p><code>webpack-dev-server</code>是一个依赖包，需要手动安装，然后在已经有<code>webpack</code>配置文件的项目目录下直接使用即可</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install webpack-dev-server -D

webpack-dev-server --mode development
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>我们也可以通过配置<code>package.json</code>来更改启动命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package.json

{
    // ...
    &quot;scripts&quot;: {
        &quot;dev&quot;: &quot;webpack-dev-server --mode development&quot;
    }
}


然后命令行使用 npm run dev 即可运行
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>PS：</strong><code>webpack-dev-server</code>默认使用<code>8080</code>端口，如果<code>webpack</code>已经配置好了<code>html-webpack-plugin</code>来构建<code>html</code>文件，那么当我们访问<code>http://localhost:8080</code>就可以看到<code>index.html</code>页面，而如果没有进行配置，那么<code>webpack-dev-server</code>会自己生成一个页面用于展示静态资源</p> <h3 id="配置-webpack-dev-server"><a href="#配置-webpack-dev-server" class="header-anchor">#</a> 配置 webpack-dev-server</h3> <p><code>devServer</code>字段是<code>webpack</code>用于配置<code>webpack-dev-server</code>的核心，我们可以在其中实现修改端口等功能</p> <h4 id="常用-devserver-配置"><a href="#常用-devserver-配置" class="header-anchor">#</a> 常用 devServer 配置</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>- port      用于指定静态服务开启的端口（默认8080）
- host      用于指定静态服务的主机名（默认是localhost）
- publicPath        用于指定构建好的静态文件在浏览器中以什么路径去访问（默认是/)
    - 例如有一个构建好的文件 output.js，完整的访问路径为 http://localhost:8080/output.js , 如果配置了 publicPath: 'assets/'，那么 output.js 的访问路径就是 http://localhost:8080/assets/output.js
    - 建议生产环境的 devServer.publicPath 与 output.publicPath 的值一致
- proxy     用于设置请求代理，即将特定URL的请求代理到另外一台服务器上（如果需要请求单独的后端服务API时，可以通过这个配置进行代理）

举个爪子
proxy: {
    '/api': {
        target: &quot;http://localhost:8000&quot;, // 将URL中带有 /api 的请求代理到 http://localhost:8000 上
        pathRewrite: { '^/api', '' } // 去掉URL中的 api 部分
        changeOrigin: true // 本地会虚拟一个服务器接受你的请求并代你发送该请求，可以解决跨域问题
    }
}

- contentBase       用于配置提供额外静态文件内容的目录，即配置额外静态文件内容的访问路径（那些不经过webpack构建，但在webpack-dev-server中提供访问的静态资源）

举个爪子：
contenBase: path.join(__dirname, &quot;public&quot;) // 当前目录下的 public
constBase: [ path.join(__dirname, &quot;public&quot;), path.join(__dirname, &quot;assets&quot; )}

- before &amp; after        用于配置用于在`webpack-dev-server`定义额外的中间件
    - before        在`webpack-dev-server`静态资源中间件处理之后，可以用于拦截部分请求返回特定内容，或者实现简单的数据mock
    - after     在webpack-dev-server静态资源中间件处理之后，可以用于打印日志等操作
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="配置-webpack-dev-middleware-中间件"><a href="#配置-webpack-dev-middleware-中间件" class="header-anchor">#</a> 配置 webpack-dev-middleware 中间件</h3> <p><code>webpack-dev-middleware</code>就是在<code>Express</code>中提供<code>webpack-dev-server</code>静态服务能力的一个中间件</p> <p><code>webpack-dev-middleware</code>是一个依赖，需要手动安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install webpack-dev-middleware --save-dev


在装有express的node服务里
const middleware = require(&quot;webpack-dev-middleware&quot;)

app.use(middleware(xxx,{
    xxx
}))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="实现一个简单的mock服务"><a href="#实现一个简单的mock服务" class="header-anchor">#</a> 实现一个简单的mock服务</h3> <p>在日常的工作中，前端人员常常会因为后端接口未完成或者数据返回参差不齐，导致页面开发完后，进度停滞不前，那么我们就需要<code>mock</code>服务来帮助我们模拟后端数据，而<code>webpack-dev-server</code>的<code>before</code>或<code>proxy</code>配置，又或者<code>webpack-dev-middleware</code>结合<code>Express</code>，都可以帮助我们实现简单的<code>mock</code>服务</p> <p>当我们请求某一个特定的路径时（如<code>/market/shopsList</code>），可以访问我们想要的数据内容</p> <p>我们先基于<code>Express app</code>实现一个简单的<code>mock</code>功能方法</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.export = function mock(app) {
    app.get('/market/shopsList', (req,res) =&gt; {
        res.json({
            data:'' // 模拟返回数据
        })
    })

    // ...
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>然后配置<code>webpack-dev-server</code>中的<code>before</code>字段</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>const mock= require('./mock')

before(app) {
    mock(app) // 调用mock函数
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/6/2019, 2:50:39 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuepress-GitPage/webpack/webpack02/" class="prev">loader 与 plugin</a></span> <span class="next"><a href="/vuepress-GitPage/webpack/webpack04/">区分开发与生产环境</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress-GitPage/assets/js/app.37ca189d.js" defer></script><script src="/vuepress-GitPage/assets/js/2.155b04c3.js" defer></script><script src="/vuepress-GitPage/assets/js/38.525fc624.js" defer></script>
  </body>
</html>
